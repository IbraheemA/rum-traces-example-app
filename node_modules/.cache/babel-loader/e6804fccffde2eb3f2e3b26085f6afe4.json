{"ast":null,"code":"import { monitor, addEventListener } from '@datadog/browser-core';\nexport function trackLocationChanges(onLocationChange) {\n  var stopHistoryTracking = trackHistory(onLocationChange).stop;\n  var stopHashTracking = trackHash(onLocationChange).stop;\n  return {\n    stop: function () {\n      stopHistoryTracking();\n      stopHashTracking();\n    }\n  };\n}\nexport function areDifferentLocation(currentLocation, otherLocation) {\n  return currentLocation.pathname !== otherLocation.pathname || !isHashAnAnchor(otherLocation.hash) && getPathFromHash(otherLocation.hash) !== getPathFromHash(currentLocation.hash);\n}\nfunction trackHistory(onHistoryChange) {\n  // eslint-disable-next-line @typescript-eslint/unbound-method\n  var originalPushState = history.pushState;\n  history.pushState = monitor(function () {\n    originalPushState.apply(this, arguments);\n    onHistoryChange();\n  });\n  // eslint-disable-next-line @typescript-eslint/unbound-method\n  var originalReplaceState = history.replaceState;\n  history.replaceState = monitor(function () {\n    originalReplaceState.apply(this, arguments);\n    onHistoryChange();\n  });\n  var removeListener = addEventListener(window, \"popstate\" /* POP_STATE */, onHistoryChange).stop;\n  var stop = function () {\n    removeListener();\n    history.pushState = originalPushState;\n    history.replaceState = originalReplaceState;\n  };\n  return {\n    stop: stop\n  };\n}\nfunction trackHash(onHashChange) {\n  return addEventListener(window, \"hashchange\" /* HASH_CHANGE */, onHashChange);\n}\nfunction isHashAnAnchor(hash) {\n  var correspondingId = hash.substr(1);\n  return !!document.getElementById(correspondingId);\n}\nfunction getPathFromHash(hash) {\n  var index = hash.indexOf('?');\n  return index < 0 ? hash : hash.slice(0, index);\n}","map":{"version":3,"names":["monitor","addEventListener","trackLocationChanges","onLocationChange","stopHistoryTracking","trackHistory","stop","stopHashTracking","trackHash","areDifferentLocation","currentLocation","otherLocation","pathname","isHashAnAnchor","hash","getPathFromHash","onHistoryChange","originalPushState","history","pushState","apply","arguments","originalReplaceState","replaceState","removeListener","window","onHashChange","correspondingId","substr","document","getElementById","index","indexOf","slice"],"sources":["../../../../src/domain/rumEventsCollection/view/trackLocationChanges.ts"],"sourcesContent":[null],"mappings":"AAAA,SAASA,OAAO,EAAEC,gBAAgB,QAAmB,uBAAuB;AAE5E,OAAM,SAAUC,oBAAoBA,CAACC,gBAA4B;EACvD,IAAMC,mBAAmB,GAAKC,YAAY,CAACF,gBAAgB,CAAC,CAAAG,IAAnC;EACzB,IAAMC,gBAAgB,GAAKC,SAAS,CAACL,gBAAgB,CAAC,CAAAG,IAAhC;EAE9B,OAAO;IACLA,IAAI,EAAE,SAAAA,CAAA;MACJF,mBAAmB,EAAE;MACrBG,gBAAgB,EAAE;IACpB;GACD;AACH;AAEA,OAAM,SAAUE,oBAAoBA,CAACC,eAAyB,EAAEC,aAAuB;EACrF,OACED,eAAe,CAACE,QAAQ,KAAKD,aAAa,CAACC,QAAQ,IAClD,CAACC,cAAc,CAACF,aAAa,CAACG,IAAI,CAAC,IAClCC,eAAe,CAACJ,aAAa,CAACG,IAAI,CAAC,KAAKC,eAAe,CAACL,eAAe,CAACI,IAAI,CAAE;AAEpF;AAEA,SAAST,YAAYA,CAACW,eAA2B;EAC/C;EACA,IAAMC,iBAAiB,GAAGC,OAAO,CAACC,SAAS;EAC3CD,OAAO,CAACC,SAAS,GAAGnB,OAAO,CAAC;IAC1BiB,iBAAiB,CAACG,KAAK,CAAC,IAAI,EAAEC,SAAgB,CAAC;IAC/CL,eAAe,EAAE;EACnB,CAAC,CAAC;EACF;EACA,IAAMM,oBAAoB,GAAGJ,OAAO,CAACK,YAAY;EACjDL,OAAO,CAACK,YAAY,GAAGvB,OAAO,CAAC;IAC7BsB,oBAAoB,CAACF,KAAK,CAAC,IAAI,EAAEC,SAAgB,CAAC;IAClDL,eAAe,EAAE;EACnB,CAAC,CAAC;EACM,IAAMQ,cAAc,GAAKvB,gBAAgB,CAACwB,MAAM,8BAAuBT,eAAe,CAAC,CAAAV,IAAnE;EAC5B,IAAMA,IAAI,GAAG,SAAAA,CAAA;IACXkB,cAAc,EAAE;IAChBN,OAAO,CAACC,SAAS,GAAGF,iBAAiB;IACrCC,OAAO,CAACK,YAAY,GAAGD,oBAAoB;EAC7C,CAAC;EACD,OAAO;IAAEhB,IAAI,EAAAA;EAAA,CAAE;AACjB;AAEA,SAASE,SAASA,CAACkB,YAAwB;EACzC,OAAOzB,gBAAgB,CAACwB,MAAM,kCAAyBC,YAAY,CAAC;AACtE;AAEA,SAASb,cAAcA,CAACC,IAAY;EAClC,IAAMa,eAAe,GAAGb,IAAI,CAACc,MAAM,CAAC,CAAC,CAAC;EACtC,OAAO,CAAC,CAACC,QAAQ,CAACC,cAAc,CAACH,eAAe,CAAC;AACnD;AAEA,SAASZ,eAAeA,CAACD,IAAY;EACnC,IAAMiB,KAAK,GAAGjB,IAAI,CAACkB,OAAO,CAAC,GAAG,CAAC;EAC/B,OAAOD,KAAK,GAAG,CAAC,GAAGjB,IAAI,GAAGA,IAAI,CAACmB,KAAK,CAAC,CAAC,EAAEF,KAAK,CAAC;AAChD","ignoreList":[]},"metadata":{},"sourceType":"module"}