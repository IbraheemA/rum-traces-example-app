{"ast":null,"code":"import { isNumber, round } from './utils';\nexport function relativeToClocks(relative) {\n  return {\n    relative: relative,\n    timeStamp: getCorrectedTimeStamp(relative)\n  };\n}\nfunction getCorrectedTimeStamp(relativeTime) {\n  var correctedOrigin = Date.now() - performance.now();\n  // apply correction only for positive drift\n  if (correctedOrigin > getNavigationStart()) {\n    // eslint-disable-next-line @typescript-eslint/restrict-plus-operands\n    return Math.round(correctedOrigin + relativeTime);\n  }\n  return getTimeStamp(relativeTime);\n}\nexport function currentDrift() {\n  // eslint-disable-next-line @typescript-eslint/restrict-plus-operands\n  return Math.round(Date.now() - (getNavigationStart() + performance.now()));\n}\nexport function toServerDuration(duration) {\n  if (!isNumber(duration)) {\n    return duration;\n  }\n  return round(duration * 1e6, 0);\n}\nexport function timeStampNow() {\n  return Date.now();\n}\nexport function relativeNow() {\n  return performance.now();\n}\nexport function clocksNow() {\n  return {\n    relative: relativeNow(),\n    timeStamp: timeStampNow()\n  };\n}\nexport function clocksOrigin() {\n  return {\n    relative: 0,\n    timeStamp: getNavigationStart()\n  };\n}\nexport function elapsed(start, end) {\n  return end - start;\n}\n/**\n * Get the time since the navigation was started.\n *\n * Note: this does not use `performance.timeOrigin` because it doesn't seem to reflect the actual\n * time on which the navigation has started: it may be much farther in the past, at least in Firefox 71.\n * Related issue in Firefox: https://bugzilla.mozilla.org/show_bug.cgi?id=1429926\n */\nexport function getRelativeTime(timestamp) {\n  return timestamp - getNavigationStart();\n}\nexport function getTimeStamp(relativeTime) {\n  // eslint-disable-next-line @typescript-eslint/restrict-plus-operands\n  return Math.round(getNavigationStart() + relativeTime);\n}\n/**\n * Navigation start slightly change on some rare cases\n */\nvar navigationStart;\nfunction getNavigationStart() {\n  if (navigationStart === undefined) {\n    navigationStart = performance.timing.navigationStart;\n  }\n  return navigationStart;\n}\nexport function resetNavigationStart() {\n  navigationStart = undefined;\n}","map":{"version":3,"names":["isNumber","round","relativeToClocks","relative","timeStamp","getCorrectedTimeStamp","relativeTime","correctedOrigin","Date","now","performance","getNavigationStart","Math","getTimeStamp","currentDrift","toServerDuration","duration","timeStampNow","relativeNow","clocksNow","clocksOrigin","elapsed","start","end","getRelativeTime","timestamp","navigationStart","undefined","timing","resetNavigationStart"],"sources":["../../src/tools/timeUtils.ts"],"sourcesContent":[null],"mappings":"AAAA,SAASA,QAAQ,EAAEC,KAAK,QAAQ,SAAS;AAQzC,OAAM,SAAUC,gBAAgBA,CAACC,QAAsB;EACrD,OAAO;IAAEA,QAAQ,EAAAA,QAAA;IAAEC,SAAS,EAAEC,qBAAqB,CAACF,QAAQ;EAAC,CAAE;AACjE;AAEA,SAASE,qBAAqBA,CAACC,YAA0B;EACvD,IAAMC,eAAe,GAAGC,IAAI,CAACC,GAAG,EAAE,GAAGC,WAAW,CAACD,GAAG,EAAE;EACtD;EACA,IAAIF,eAAe,GAAGI,kBAAkB,EAAE,EAAE;IAC1C;IACA,OAAOC,IAAI,CAACX,KAAK,CAACM,eAAe,GAAGD,YAAY,CAAc;;EAEhE,OAAOO,YAAY,CAACP,YAAY,CAAC;AACnC;AAEA,OAAM,SAAUQ,YAAYA,CAAA;EAC1B;EACA,OAAOF,IAAI,CAACX,KAAK,CAACO,IAAI,CAACC,GAAG,EAAE,IAAIE,kBAAkB,EAAE,GAAGD,WAAW,CAACD,GAAG,EAAE,CAAC,CAAC;AAC5E;AAIA,OAAM,SAAUM,gBAAgBA,CAACC,QAA8B;EAC7D,IAAI,CAAChB,QAAQ,CAACgB,QAAQ,CAAC,EAAE;IACvB,OAAOA,QAAQ;;EAEjB,OAAOf,KAAK,CAACe,QAAQ,GAAG,GAAG,EAAE,CAAC,CAAmB;AACnD;AAEA,OAAM,SAAUC,YAAYA,CAAA;EAC1B,OAAOT,IAAI,CAACC,GAAG,EAAe;AAChC;AAEA,OAAM,SAAUS,WAAWA,CAAA;EACzB,OAAOR,WAAW,CAACD,GAAG,EAAkB;AAC1C;AAEA,OAAM,SAAUU,SAASA,CAAA;EACvB,OAAO;IAAEhB,QAAQ,EAAEe,WAAW,EAAE;IAAEd,SAAS,EAAEa,YAAY;EAAE,CAAE;AAC/D;AAEA,OAAM,SAAUG,YAAYA,CAAA;EAC1B,OAAO;IAAEjB,QAAQ,EAAE,CAAiB;IAAEC,SAAS,EAAEO,kBAAkB;EAAE,CAAE;AACzE;AAIA,OAAM,SAAUU,OAAOA,CAACC,KAAa,EAAEC,GAAW;EAChD,OAAQA,GAAG,GAAGD,KAAK;AACrB;AAEA;;;;;;;AAOA,OAAM,SAAUE,eAAeA,CAACC,SAAoB;EAClD,OAAQA,SAAS,GAAGd,kBAAkB,EAAE;AAC1C;AAEA,OAAM,SAAUE,YAAYA,CAACP,YAA0B;EACrD;EACA,OAAOM,IAAI,CAACX,KAAK,CAACU,kBAAkB,EAAE,GAAGL,YAAY,CAAc;AACrE;AAEA;;;AAGA,IAAIoB,eAAsC;AAE1C,SAASf,kBAAkBA,CAAA;EACzB,IAAIe,eAAe,KAAKC,SAAS,EAAE;IACjCD,eAAe,GAAGhB,WAAW,CAACkB,MAAM,CAACF,eAA4B;;EAEnE,OAAOA,eAAe;AACxB;AAEA,OAAM,SAAUG,oBAAoBA,CAAA;EAClCH,eAAe,GAAGC,SAAS;AAC7B","ignoreList":[]},"metadata":{},"sourceType":"module"}