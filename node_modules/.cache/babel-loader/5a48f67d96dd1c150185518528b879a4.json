{"ast":null,"code":"import { __assign } from \"tslib\";\nimport { areCookiesAuthorized } from '../browser/cookie';\nimport { buildConfiguration } from '../domain/configuration';\nimport { setDebugMode, startInternalMonitoring } from '../domain/internalMonitoring';\nimport { catchUserErrors } from '../tools/catchUserErrors';\nimport { display } from '../tools/display';\nexport function makePublicApi(stub) {\n  var publicApi = __assign(__assign({}, stub), {\n    // This API method is intentionally not monitored, since the only thing executed is the\n    // user-provided 'callback'.  All SDK usages executed in the callback should be monitored, and\n    // we don't want to interfere with the user uncaught exceptions.\n    onReady: function (callback) {\n      callback();\n    }\n  });\n  // Add an \"hidden\" property to set debug mode. We define it that way to hide it\n  // as much as possible but of course it's not a real protection.\n  Object.defineProperty(publicApi, '_setDebug', {\n    get: function () {\n      return setDebugMode;\n    },\n    enumerable: false\n  });\n  return publicApi;\n}\nexport function defineGlobal(global, name, api) {\n  var existingGlobalVariable = global[name];\n  global[name] = api;\n  if (existingGlobalVariable && existingGlobalVariable.q) {\n    existingGlobalVariable.q.forEach(function (fn) {\n      return catchUserErrors(fn, 'onReady callback threw an error:')();\n    });\n  }\n}\nexport var BuildMode;\n(function (BuildMode) {\n  BuildMode[\"RELEASE\"] = \"release\";\n  BuildMode[\"STAGING\"] = \"staging\";\n  BuildMode[\"E2E_TEST\"] = \"e2e-test\";\n})(BuildMode || (BuildMode = {}));\nexport function commonInit(userConfiguration, buildEnv) {\n  var configuration = buildConfiguration(userConfiguration, buildEnv);\n  var internalMonitoring = startInternalMonitoring(configuration);\n  return {\n    configuration: configuration,\n    internalMonitoring: internalMonitoring\n  };\n}\nexport function checkCookiesAuthorized(options) {\n  if (!areCookiesAuthorized(options)) {\n    display.warn('Cookies are not authorized, we will not send any data.');\n    return false;\n  }\n  return true;\n}\nexport function checkIsNotLocalFile() {\n  if (isLocalFile()) {\n    display.error('Execution is not allowed in the current context.');\n    return false;\n  }\n  return true;\n}\nfunction isLocalFile() {\n  return window.location.protocol === 'file:';\n}","map":{"version":3,"names":["areCookiesAuthorized","buildConfiguration","setDebugMode","startInternalMonitoring","catchUserErrors","display","makePublicApi","stub","publicApi","__assign","onReady","callback","Object","defineProperty","get","enumerable","defineGlobal","global","name","api","existingGlobalVariable","q","forEach","fn","BuildMode","commonInit","userConfiguration","buildEnv","configuration","internalMonitoring","checkCookiesAuthorized","options","warn","checkIsNotLocalFile","isLocalFile","error","window","location","protocol"],"sources":["../../src/boot/init.ts"],"sourcesContent":[null],"mappings":";AAAA,SAASA,oBAAoB,QAAuB,mBAAmB;AACvE,SAASC,kBAAkB,QAA2B,yBAAyB;AAC/E,SAASC,YAAY,EAAEC,uBAAuB,QAAQ,8BAA8B;AAEpF,SAASC,eAAe,QAAQ,0BAA0B;AAC1D,SAASC,OAAO,QAAQ,kBAAkB;AAE1C,OAAM,SAAUC,aAAaA,CAAIC,IAAO;EACtC,IAAMC,SAAS,GAAAC,QAAA,CAAAA,QAAA,KACVF,IAAI;IAEP;IACA;IACA;IACAG,OAAO,EAAP,SAAAA,CAAQC,QAAoB;MAC1BA,QAAQ,EAAE;IACZ;EAAC,EACF;EAED;EACA;EACAC,MAAM,CAACC,cAAc,CAACL,SAAS,EAAE,WAAW,EAAE;IAC5CM,GAAG,WAAAA,CAAA;MACD,OAAOZ,YAAY;IACrB,CAAC;IACDa,UAAU,EAAE;GACb,CAAC;EAEF,OAAOP,SAAS;AAClB;AAEA,OAAM,SAAUQ,YAAYA,CAAoCC,MAAc,EAAEC,IAAU,EAAEC,GAAiB;EAC3G,IAAMC,sBAAsB,GAA0CH,MAAM,CAACC,IAAI,CAAC;EAClFD,MAAM,CAACC,IAAI,CAAC,GAAGC,GAAG;EAClB,IAAIC,sBAAsB,IAAIA,sBAAsB,CAACC,CAAC,EAAE;IACtDD,sBAAsB,CAACC,CAAC,CAACC,OAAO,CAAC,UAACC,EAAE;MAAK,OAAAnB,eAAe,CAACmB,EAAE,EAAE,kCAAkC,CAAC,EAAE;IAAzD,CAAyD,CAAC;;AAEvG;AAEA,WAAYC,SAIX;AAJD,WAAYA,SAAS;EACnBA,SAAA,uBAAmB;EACnBA,SAAA,uBAAmB;EACnBA,SAAA,yBAAqB;AACvB,CAAC,EAJWA,SAAS,KAATA,SAAS;AAYrB,OAAM,SAAUC,UAAUA,CAACC,iBAAoC,EAAEC,QAAkB;EACjF,IAAMC,aAAa,GAAG3B,kBAAkB,CAACyB,iBAAiB,EAAEC,QAAQ,CAAC;EACrE,IAAME,kBAAkB,GAAG1B,uBAAuB,CAACyB,aAAa,CAAC;EAEjE,OAAO;IACLA,aAAa,EAAAA,aAAA;IACbC,kBAAkB,EAAAA;GACnB;AACH;AAEA,OAAM,SAAUC,sBAAsBA,CAACC,OAAsB;EAC3D,IAAI,CAAC/B,oBAAoB,CAAC+B,OAAO,CAAC,EAAE;IAClC1B,OAAO,CAAC2B,IAAI,CAAC,wDAAwD,CAAC;IACtE,OAAO,KAAK;;EAEd,OAAO,IAAI;AACb;AAEA,OAAM,SAAUC,mBAAmBA,CAAA;EACjC,IAAIC,WAAW,EAAE,EAAE;IACjB7B,OAAO,CAAC8B,KAAK,CAAC,kDAAkD,CAAC;IACjE,OAAO,KAAK;;EAEd,OAAO,IAAI;AACb;AAEA,SAASD,WAAWA,CAAA;EAClB,OAAOE,MAAM,CAACC,QAAQ,CAACC,QAAQ,KAAK,OAAO;AAC7C","ignoreList":[]},"metadata":{},"sourceType":"module"}